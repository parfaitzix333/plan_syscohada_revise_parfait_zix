<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Comptable SYSCOHADA Révisé - Parfait Zix</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SheetJS pour l'export Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #1abc9c;
            --warning-color: #f39c12;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .header-section {
            background: linear-gradient(135deg, var(--primary-color), #1a2530);
            color: white;
            padding: 30px 0;
            border-radius: 0 0 20px 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .header-section h2 {
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header-section h3 {
            font-weight: 300;
            opacity: 0.9;
            font-size: 1.2rem;
        }

        .warning-box {
            background-color: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning-color);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .developer-info {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 10px;
        }

        .airtable-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .airtable-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }

        #airtable-iframe-container {
            position: relative;
            margin-bottom: 15px;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        #airtable-iframe-container.fullscreen {
            background: #f5f5f5;
            padding: 10px;
        }

        .airtable-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .airtable-embed {
            border-radius: 10px;
            border: 1px solid #e1e5eb;
            transition: height 0.3s ease;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .feature-card i {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }

        .feature-card h4 {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .stats-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }

        .stat-item {
            text-align: center;
            padding: 15px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        .btn-airtable {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .btn-airtable:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(238, 90, 82, 0.3);
            color: white;
        }

        .floating-buttons {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border: none;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            color: white;
        }

        .floating-btn-primary {
            background: linear-gradient(135deg, var(--secondary-color), #2980b9);
        }

        .floating-btn-success {
            background: linear-gradient(135deg, var(--accent-color), #16a085);
        }

        .floating-btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #e67e22);
        }

        .fullscreen-btn {
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3);
            color: white;
        }

        .fullscreen-btn.fullscreen-active {
            background: linear-gradient(135deg, #e17055, #fab1a0);
        }

        footer {
            background-color: var(--primary-color);
            color: white;
            padding: 30px 0;
            margin-top: 50px;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: white;
        }

        .copyright {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .floating-buttons {
                bottom: 20px;
                right: 20px;
            }

            .header-section {
                padding: 20px 0;
                border-radius: 0 0 15px 15px;
            }

            .airtable-container {
                padding: 15px;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .airtable-controls {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        @media (max-width: 576px) {
            .header-section h2 {
                font-size: 1.8rem;
            }

            .header-section h3 {
                font-size: 1rem;
            }

            .floating-buttons {
                bottom: 15px;
                right: 15px;
            }

            .floating-btn {
                width: 45px;
                height: 45px;
                font-size: 1rem;
            }

            .airtable-embed {
                height: 400px !important;
            }
        }
    </style>
</head>

<body>
    <!-- En-tête -->
    <div class="header-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h2><i class="fas fa-book"></i> Plan Comptable SYSCOHADA Révisé</h2>
                    <h3>Modèle de plan comptable OHADA révisé intégré dans Airtable pour une gestion simplifiée et
                        efficace des comptes</h3>
                </div>
                <div class="col-lg-4 text-lg-end mt-3 mt-lg-0">
                    <a href="https://airtable.com/appSSfKoJ5lABN8Ov/shr0DauqAwAEBUiZV" target="_blank"
                        class="btn-airtable">
                        <i class="fas fa-external-link-alt"></i> Ouvrir dans Airtable
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenu principal -->
    <div class="container">
        <!-- Section d'avertissement -->
        <div class="warning-box">
            <h5><i class="fas fa-exclamation-triangle"></i> <b>Avertissement important</b></h5>
            <p class="mb-0">Les données exploitées sur cette page ont été extraites d'un fichier JSON et ont subi une
                transformation pour une structuration adaptée à Airtable. Il est donc possible de rencontrer de petits
                décalages non constatés par le concepteur.</p>
        </div>

        <!-- Section développeur -->
        <div class="developer-info text-center">
            <p><i class="fas fa-code"></i> Développé par l'analyste programmeur <strong>Parfait Zix</strong> • © 2026 •
                Dernière mise à jour : Janvier 2026</p>
        </div>

        <!-- Section fonctionnalités -->
        <div class="features-grid">
            <div class="feature-card">
                <i class="fas fa-search"></i>
                <h4>Recherche Avancée</h4>
                <p>Filtrez et recherchez rapidement les comptes par numéro, libellé ou classe</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-sync-alt"></i>
                <h4>Mise à Jour Dynamique</h4>
                <p>Les données se synchronisent automatiquement avec Airtable</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-expand-alt"></i>
                <h4>Mode Plein Écran</h4>
                <p>Explorez les données en plein écran pour une meilleure visibilité</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-mobile-alt"></i>
                <h4>Accessible Partout</h4>
                <p>Interface responsive compatible avec tous les appareils</p>
            </div>
        </div>

        <!-- Section statistiques -->
        <div class="stats-container">
            <div class="row text-center">
                <div class="col-md-3 col-6">
                    <div class="stat-item">
                        <span class="stat-number" id="total-accounts">0</span>
                        <span class="stat-label">Comptes Totaux</span>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="stat-item">
                        <span class="stat-number">9</span>
                        <span class="stat-label">Classes</span>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="stat-item">
                        <span class="stat-number">3</span>
                        <span class="stat-label">Groupes</span>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="stat-item">
                        <span class="stat-number" id="updated-time">Aujourd'hui</span>
                        <span class="stat-label">Dernière mise à jour</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section Airtable -->
        <div class="airtable-container">
            <h3 class="mb-4"><i class="fas fa-table"></i> Exploration du Plan Comptable</h3>
            <p class="text-muted mb-4">Utilisez les filtres intégrés d'Airtable pour explorer le plan comptable complet.
                Vous pouvez trier, filtrer et rechercher selon vos besoins.</p>

            <!-- Contrôles Airtable -->
            <div class="airtable-controls">
                <div>
                    <button id="fullscreen-btn" class="fullscreen-btn">
                        <i class="fas fa-expand-alt"></i> Plein écran
                    </button>
                    <button id="refresh-btn" class="btn btn-outline-primary btn-sm ms-2">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                </div>
                <div>
                    <span class="badge bg-info">
                        <i class="fas fa-info-circle"></i> Utilisez Ctrl+F pour rechercher
                    </span>
                </div>
            </div>

            <!-- Conteneur de l'iframe -->
            <div id="airtable-iframe-container">
                <iframe class="airtable-embed" id="airtable-iframe"
                    src="https://airtable.com/embed/appSSfKoJ5lABN8Ov/shr0DauqAwAEBUiZV" frameborder="0" onmousewheel=""
                    width="100%" height="600" style="background: transparent;">
                </iframe>
            </div>

            <div class="mt-4">
                <div class="alert alert-info">
                    <i class="fas fa-lightbulb"></i> <strong>Astuce :</strong> Utilisez le bouton "Plein écran" pour une
                    meilleure exploration des données. Dans le mode plein écran, vous pouvez utiliser Ctrl+F pour
                    rechercher du texte directement dans le tableau.
                </div>
            </div>
        </div>

        <!-- Section d'export -->
        <div class="airtable-container">
            <h3 class="mb-4"><i class="fas fa-file-export"></i> Export des Données</h3>
            <p class="text-muted mb-4">Exportez les données filtrées ou complètes dans différents formats pour vos
                besoins d'analyse ou de reporting.</p>

            <div class="row g-3">
                <div class="col-md-4">
                    <button class="btn btn-success w-100" onclick="exportToExcel()">
                        <i class="fas fa-file-excel"></i> Exporter en Excel
                    </button>
                </div>
                <div class="col-md-4">
                    <button class="btn btn-primary w-100" onclick="exportToCSV()">
                        <i class="fas fa-file-csv"></i> Exporter en CSV
                    </button>
                </div>
                <div class="col-md-4">
                    <button class="btn btn-secondary w-100" onclick="exportToJSON()">
                        <i class="fas fa-file-code"></i> Exporter en JSON
                    </button>
                </div>
            </div>

            <div class="mt-3">
                <small class="text-muted"><i class="fas fa-info-circle"></i> L'export se base sur les données
                    actuellement affichées dans Airtable</small>
            </div>
        </div>
    </div>

    <!-- Boutons flottants -->
    <div class="floating-buttons">
        <button class="floating-btn floating-btn-primary" onclick="scrollToTop()" title="Remonter en haut">
            <i class="fas fa-arrow-up"></i>
        </button>
        <button class="floating-btn floating-btn-success" onclick="scrollToAirtable()" title="Aller à Airtable">
            <i class="fas fa-table"></i>
        </button>
        <button class="floating-btn floating-btn-warning" onclick="refreshData()" title="Actualiser les données">
            <i class="fas fa-sync-alt"></i>
        </button>
    </div>

    <!-- Pied de page -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <h5>Plan Comptable SYSCOHADA Révisé</h5>
                <p>Une solution moderne pour l'accès et la gestion du plan comptable OHADA</p>

                <div class="footer-links">
                    <a href="https://github.com" target="_blank" class="footer-link">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                    <a href="https://ohada.org" target="_blank" class="footer-link">
                        <i class="fas fa-globe"></i> OHADA
                    </a>
                    <a href="https://airtable.com" target="_blank" class="footer-link">
                        <i class="fas fa-cloud"></i> Airtable
                    </a>
                    <a href="mailto:parfaitzix333@gmail.com" class="footer-link">
                        <i class="fas fa-envelope"></i> Contact
                    </a>
                </div>

                <div class="copyright">
                    <p>© 2026 <b class="text-danger">Parfait Zix</b> - Analyste Programmeur. Tous droits réservés.</p>
                    <p>Cette interface utilise Airtable pour l'hébergement et la gestion des données.</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Fonction pour faire défiler vers le haut
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Fonction pour faire défiler vers la section Airtable
        function scrollToAirtable() {
            const airtableSection = document.querySelector('.airtable-container');
            if (airtableSection) {
                airtableSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Fonction pour actualiser les données
        function refreshData() {
            const iframe = document.getElementById('airtable-iframe');
            if (iframe) {
                iframe.src = iframe.src;
            }
            document.getElementById('updated-time').textContent = 'Maintenant';

            // Afficher une notification
            showNotification('Données actualisées avec succès', 'success');
        }

        // Fonction pour exporter en Excel
        function exportToExcel() {
            showNotification('Fonction d\'export Excel en développement', 'info');
            // Implémentation future: Récupérer les données depuis Airtable API
        }

        // Fonction pour exporter en CSV
        function exportToCSV() {
            showNotification('Fonction d\'export CSV en développement', 'info');
            // Implémentation future: Récupérer les données depuis Airtable API
        }

        // Fonction pour exporter en JSON
        function exportToJSON() {
            showNotification('Fonction d\'export JSON en développement', 'info');
            // Implémentation future: Récupérer les données depuis Airtable API
        }

        // Fonction pour afficher les notifications
        function showNotification(message, type = 'info') {
            // Créer l'élément de notification
            const notification = document.createElement('div');
            notification.className = `alert alert-${type} alert-dismissible fade show`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '300px';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;

            // Ajouter à la page
            document.body.appendChild(notification);

            // Supprimer automatiquement après 5 secondes
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }

        // Simuler le comptage des comptes
        function simulateAccountCount() {
            const approximateCount = 850;
            let currentCount = 0;

            const interval = setInterval(() => {
                if (currentCount < approximateCount) {
                    currentCount += Math.floor(Math.random() * 10) + 5;
                    if (currentCount > approximateCount) {
                        currentCount = approximateCount;
                    }
                    document.getElementById('total-accounts').textContent = currentCount;
                } else {
                    clearInterval(interval);
                }
            }, 50);
        }

        // Bouton pour plein écran
        $(document).ready(function () {
            $('#fullscreen-btn').click(function () {
                const iframeContainer = $('#airtable-iframe-container');
                const iframe = iframeContainer.find('iframe');
                const fullscreenBtn = $(this);

                if (!document.fullscreenElement) {
                    iframeContainer[0].requestFullscreen().then(() => {
                        // Ajuster la hauteur de l'iframe en plein écran
                        iframe.css('height', 'calc(100vh - 20px)');
                        iframeContainer.addClass('fullscreen');
                        fullscreenBtn.html('<i class="fas fa-compress-alt"></i> Quitter le plein écran');
                        fullscreenBtn.addClass('fullscreen-active');

                        // Notification
                        showNotification('Mode plein écran activé. Appuyez sur Échap pour quitter.', 'info');
                    }).catch(err => {
                        console.error('Erreur de plein écran:', err);
                        showNotification('Impossible d\'activer le plein écran', 'warning');
                    });
                } else {
                    document.exitFullscreen();
                    iframe.css('height', '600px');
                    iframeContainer.removeClass('fullscreen');
                    fullscreenBtn.html('<i class="fas fa-expand-alt"></i> Plein écran');
                    fullscreenBtn.removeClass('fullscreen-active');
                }
            });

            // Gérer la sortie du plein écran avec la touche Échap
            $(document).on('fullscreenchange', function () {
                const iframeContainer = $('#airtable-iframe-container');
                const iframe = iframeContainer.find('iframe');
                const fullscreenBtn = $('#fullscreen-btn');

                if (!document.fullscreenElement) {
                    iframe.css('height', '600px');
                    iframeContainer.removeClass('fullscreen');
                    fullscreenBtn.html('<i class="fas fa-expand-alt"></i> Plein écran');
                    fullscreenBtn.removeClass('fullscreen-active');
                }
            });

            // Bouton d'actualisation
            $('#refresh-btn').click(function () {
                refreshData();
            });

            // Gestion du clavier pour le plein écran
            $(document).keydown(function (e) {
                // Échap pour quitter le plein écran
                if (e.key === 'Escape' && document.fullscreenElement) {
                    document.exitFullscreen();
                }

                // Ctrl+F pour rechercher (même en plein écran)
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    showNotification('Utilisez la recherche intégrée d\'Airtable (barre de recherche en haut)', 'info');
                }
            });
        });

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function () {
            // Simuler le chargement des comptes
            simulateAccountCount();

            // Mettre à jour l'heure
            const now = new Date();
            document.getElementById('updated-time').textContent =
                `${now.getDate()}/${now.getMonth() + 1}/${now.getFullYear()}`;

            // Ajouter un effet de chargement
            const iframe = document.getElementById('airtable-iframe');
            if (iframe) {
                iframe.onload = function () {
                    showNotification('Plan comptable chargé avec succès', 'success');
                };
            }

            console.log('Interface SYSCOHADA chargée avec succès');
            console.log('Source des données: Airtable');
            console.log('Développeur: Parfait Zix');
        });

        // Gestion des erreurs
        window.addEventListener('error', function (e) {
            console.error('Erreur détectée:', e.error);
            showNotification('Une erreur est survenue lors du chargement', 'danger');
        });
    </script>
</body>

</html>